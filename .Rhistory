legend.position = "right") +  #remove minor-grid labels
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
pdf("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 9)
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.8) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right") +  #remove minor-grid labels
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
dev.off()
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.9) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right") +  #remove minor-grid labels
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.95) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right") +  #remove minor-grid labels
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
pdf("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 9)
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.95) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right") +  #remove minor-grid labels
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
dev.off()
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.9) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right") +  #remove minor-grid labels
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
pdf("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 9)
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.9) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right") +  #remove minor-grid labels
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
dev.off()
pdf("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 9)
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.85) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right") +  #remove minor-grid labels
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
dev.off()
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.85) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 5),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right") +  #remove minor-grid labels
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.85) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 10),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right") +  #remove minor-grid labels
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
pdf("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 9)
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.85) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 10),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right") +  #remove minor-grid labels
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
dev.off()
pdf("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 12)
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.85) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 10),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right") +  #remove minor-grid labels
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
dev.off()
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.85) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 10),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right",
plot.margin = margin(t = 10, r = 50, b = 10, l = 50, unit = "pt")) +
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
pdf("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 12)
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.85) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 10),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right",
plot.margin = margin(t = 10, r = 50, b = 10, l = 50, unit = "pt")) +
labs(title = "Nygaard dataset samples Genus-level composition",
#subtitle = "",
caption = date())
dev.off()
pdf("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 12)
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.2, width = 0.85) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 10),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right",
plot.margin = margin(t = 10, r = 50, b = 10, l = 50, unit = "pt")) +
labs(title = "Nygaard dataset samples Genus-level composition")
#subtitle = "",
#caption = date())
dev.off()
pdf("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 12)
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.15, width = 0.85) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 10),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right",
plot.margin = margin(t = 10, r = 50, b = 10, l = 50, unit = "pt")) +
labs(title = "Nygaard dataset samples Genus-level composition")
#subtitle = "",
#caption = date())
dev.off()
#pdf("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 12)
jpeg("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 12, res = 1200)
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.15, width = 0.85) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 10),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right",
plot.margin = margin(t = 10, r = 50, b = 10, l = 50, unit = "pt")) +
labs(title = "Nygaard dataset samples Genus-level composition")
#subtitle = "",
#caption = date())
dev.off()
#pdf("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 12)
jpeg("Figs/Pipelines_Genus_composition.jpg", he = 6, wi = 12, res = 1200)
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.15, width = 0.85) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 10),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right",
plot.margin = margin(t = 10, r = 50, b = 10, l = 50, unit = "pt")) +
labs(title = "Nygaard dataset samples Genus-level composition")
#subtitle = "",
#caption = date())
dev.off()
?jpeg()
#pdf("Figs/Pipelines_Genus_composition.pdf", he = 6, wi = 12)
jpeg("Figs/Pipelines_Genus_composition.jpg", he = 6, wi = 12, units = "in", res = 1200)
ggplot(sub_Genus.melted, aes(x = Sample, y = Abundance, fill = Genus), color = "black") +
theme_bw() +
#facet_wrap(~ Pipeline) +
#geom_bar(stat = "identity", color = "black") +
geom_bar(stat = "identity", color = "black", size = 0.15, width = 0.85) +
scale_fill_manual(values = couleurs_genus) +
ylab("Relative Abundance") +
scale_y_continuous(expand = c(0,0)) + #remove the space below the 0 of the y axis in the graph
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 10),
axis.ticks.x = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),  #remove major-grid labels
panel.grid.minor = element_blank(),
legend.position = "right",
plot.margin = margin(t = 10, r = 50, b = 10, l = 50, unit = "pt")) +
labs(title = "Nygaard dataset samples Genus-level composition")
#subtitle = "",
#caption = date())
dev.off()
alpha_tab_NanoASV <- alpha_tab[alpha_tab$Pipeline == "NanoASV",]
alpha_tab_NanoASV <- alpha_tab[alpha_tab$Pipeline == "NanoASV",]
alpha_tab_Nygaard <- alpha_tab[alpha_tab$Pipeline == "Nygaard",]
alpha_tab_SituSeq <- alpha_tab[alpha_tab$Pipeline == "SituSeq",]
View(alpha_tab_NanoASV)
mod <- lm(alpha_tab_NanoASV$richness ~ alpha_tab_Nygaard$richness)
summary(mod)
mod <- lm(alpha_tab_NanoASV$shannon ~ alpha_tab_Nygaard$shannon)
summary(mod)
mod <- lm(alpha_tab_NanoASV$richness ~ alpha_tab_SituSeq$richness)
summary(mod)
mod <- lm(alpha_tab_NanoASV$shannon ~ alpha_tab_SituSeq$shannon)
summary(mod)
ggplot(aes(x = alpha_tab_NanoASV$richness, y = alpha_tab_Nygaard$richness)) +
ggplot(aes(x = alpha_tab_NanoASV$richness, y = alpha_tab_Nygaard$richness)) +
theme_bw() +
geom_point() +
geom_smooth(method = "lm") +
labs(title = "",
subtitle = "")
plot(alpha_tab_NanoASV$richness ~ alpha_tab_Nygaard$richness)
plot(alpha_tab_NanoASV$shannon ~ alpha_tab_Nygaard$shannon)
plot(alpha_tab_NanoASV$richness ~ alpha_tab_SituSeq$richness)
mod <- lm(alpha_tab_NanoASV$shannon ~ alpha_tab_SituSeq$shannon)
summary(mod)
plot(alpha_tab_NanoASV$shannon ~ alpha_tab_SituSeq$shannon)
mod <- lm(alpha_tab_Nygaardrichness ~ alpha_tab_SituSeq$richness)
summary(mod)
mod <- lm(alpha_tab_NanoASV$richness ~ alpha_tab_SituSeq$richness)
summary(mod)
plot(alpha_tab_NanoASV$richness ~ alpha_tab_SituSeq$richness)
mod <- lm(alpha_tab_Nygaard$richness ~ alpha_tab_SituSeq$richness)
summary(mod)
plot(alpha_tab_Nygaard$richness ~ alpha_tab_SituSeq$richness)
plot(alpha_tab_Nygaard$shannon ~ alpha_tab_SituSeq$shannon)
mod <- lm(alpha_tab_Nygaard$shannon ~ alpha_tab_SituSeq$shannon)
summary(mod)
plot(alpha_tab_Nygaard$shannon ~ alpha_tab_SituSeq$shannon)
dist.bray <- vegdist(t(MOCK.genus@otu_table), method = "bray")
pcoa.sub <- pcoa(dist.bray)
beta_tab <- cbind(pcoa.sub$vectors[,1:2], MOCK.genus@sam_data)
ggplot(beta_tab) + theme_bw() +
geom_point(aes(x = Axis.1, y = Axis.2,
color = Pipeline),
size = 5) +
geom_text(data = beta_tab, aes(x = Axis.1, y = Axis.2), label = sub("_.*$", "", rownames(beta_tab)), size = 4) +
# scale_color_manual(breaks = waiver(),
#                    values = c("#69E972", "blue", "brown", "cyan")) +
geom_hline(yintercept = 0, lty = 3) +
geom_vline(xintercept = 0, lty = 3) +
xlab(paste("PCo1 (", round(pcoa.sub$values$Relative_eig[1]*100, 1), "%)")) +
ylab(paste("PCo2 (", round(pcoa.sub$values$Relative_eig[2]*100, 1), "%)")) +
labs(title = "Nygaard dataset Bacterial population PCoA \nBray-Curtis distance matrix",
#subtitle = "Plot of length by dose",
caption = date(),
color = "Pipeline",
shape = "Sample")
NanoASV.beta <- subset_samples(MOCK.genus, MOCK.genus@sam_data$Pipeline == "NanoASV")
dist.bray <- vegdist(t(NanoASV.beta@otu_table), method = "bray")
dist.NanoASV <- dist.bray
pcoa.sub <- pcoa(dist.bray)
beta_tab <- cbind(pcoa.sub$vectors[,1:2], NanoASV.beta@sam_data)
ggplot(beta_tab) + theme_bw() +
geom_point(aes(x = Axis.1, y = Axis.2),
color = "red",
size = 5) +
geom_text(data = beta_tab, aes(x = Axis.1, y = Axis.2), label = sub("_.*$", "", rownames(beta_tab)), size = 4) +
# scale_color_manual(breaks = waiver(),
#                    values = c("#69E972", "blue", "brown", "cyan")) +
geom_hline(yintercept = 0, lty = 3) +
geom_vline(xintercept = 0, lty = 3) +
xlab(paste("PCo1 (", round(pcoa.sub$values$Relative_eig[1]*100, 1), "%)")) +
ylab(paste("PCo2 (", round(pcoa.sub$values$Relative_eig[2]*100, 1), "%)")) +
labs(title = "Nygaard dataset Bacterial population PCoA \nBray-Curtis distance matrix \nNanoASV workflow",
#subtitle = "Plot of length by dose",
caption = date(),
color = "Pipeline",
shape = "Sample")
dev.off()
Nygaard.beta <- subset_samples(MOCK.genus, MOCK.genus@sam_data$Pipeline == "Nygaard")
dist.bray <- vegdist(t(Nygaard.beta@otu_table), method = "bray")
dist.Nygaard <- dist.bray
pcoa.sub <- pcoa(dist.bray)
beta_tab <- cbind(pcoa.sub$vectors[,1:2], Nygaard.beta@sam_data)
ggplot(beta_tab) + theme_bw() +
geom_point(aes(x = Axis.1, y = Axis.2),
color = "lightgreen",
size = 5) +
geom_text(data = beta_tab, aes(x = Axis.1, y = Axis.2), label = sub("_.*$", "", rownames(beta_tab)), size = 4) +
# scale_color_manual(breaks = waiver(),
#                    values = c("#69E972", "blue", "brown", "cyan")) +
geom_hline(yintercept = 0, lty = 3) +
geom_vline(xintercept = 0, lty = 3) +
xlab(paste("PCo1 (", round(pcoa.sub$values$Relative_eig[1]*100, 1), "%)")) +
ylab(paste("PCo2 (", round(pcoa.sub$values$Relative_eig[2]*100, 1), "%)")) +
labs(title = "Nygaard dataset Bacterial population PCoA \nBray-Curtis distance matrix \nNygaard pipeline",
#subtitle = "Plot of length by dose",
caption = date(),
color = "Pipeline",
shape = "Sample")
dev.off()
SituSeq.beta <- subset_samples(MOCK.genus, MOCK.genus@sam_data$Pipeline == "SituSeq")
dist.bray <- vegdist(t(SituSeq.beta@otu_table), method = "bray")
dist.SituSeq <- dist.bray
pcoa.sub <- pcoa(dist.bray)
beta_tab <- cbind(pcoa.sub$vectors[,1:2], SituSeq.beta@sam_data)
ggplot(beta_tab) + theme_bw() +
geom_point(aes(x = Axis.1, y = Axis.2),
color = "lightblue",
size = 5) +
geom_text(data = beta_tab, aes(x = Axis.1, y = Axis.2), label = sub("_.*$", "", rownames(beta_tab)), size = 4) +
# scale_color_manual(breaks = waiver(),
#                    values = c("#69E972", "blue", "brown", "cyan")) +
geom_hline(yintercept = 0, lty = 3) +
geom_vline(xintercept = 0, lty = 3) +
xlab(paste("PCo1 (", round(pcoa.sub$values$Relative_eig[1]*100, 1), "%)")) +
ylab(paste("PCo2 (", round(pcoa.sub$values$Relative_eig[2]*100, 1), "%)")) +
labs(title = "Nygaard dataset Bacterial population PCoA \nBray-Curtis distance matrix \nNygaard pipeline",
#subtitle = "Plot of length by dose",
caption = date(),
color = "Pipeline",
shape = "Sample")
dev.off()
library(vegan)
mantel(dist.NanoASV, dist.Nygaard)
mantel(dist.NanoASV, dist.Nygaard)
mantel(dist.NanoASV, dist.Nygaard)
mantel(dist.NanoASV, dist.SituSeq)
mantel(dist.Nygaard, dist.SituSeq)
mantel(dist.NanoASV, dist.SituSeq)
mantel(dist.Nygaard, dist.SituSeq)
mantel(dist.NanoASV, dist.SituSeq)
mantel(dist.Nygaard, dist.SituSeq)
mod <- lm(alpha_tab_NanoASV$richness ~ alpha_tab_Nygaard$richness)
summary(mod)
plot(alpha_tab_NanoASV$richness ~ alpha_tab_Nygaard$richness)
mod <- lm(alpha_tab_NanoASV$shannon ~ alpha_tab_Nygaard$shannon)
summary(mod)
df <- data.frame(NanoASV_richness = alpha_tab_NanoASV$richness,
Nygaard_richness = alpha_tab_Nygaard$richness,
SituSeq_richness = alpha_tab_SituSeq$richness)
View(df)
library(corrplot)
cor(df)
shannon_df <- data.frame(NanoASV_shannon = alpha_tab_NanoASV$shannon,
Nygaard_shannon = alpha_tab_Nygaard$shannon,
SituSeq_shannon = alpha_tab_SituSeq$shannon)
cor(shannon_df)
View(Genus.melted)
